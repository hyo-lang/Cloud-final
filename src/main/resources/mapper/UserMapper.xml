<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cloud.shop.dao.UserDao">

    <insert id="insertUser" parameterType="com.cloud.shop.dto.UserDto">
        INSERT INTO USER (userName, userPwd, userEmail, userGender, grade)
        VALUES (#{userName}, #{userPwd}, #{userEmail}, #{userGender}, #{grade})
    </insert>

    <select id="findByUserEmailAndUserPwd" parameterType="map" resultType="com.cloud.shop.dto.UserDto">
        SELECT 
            userNum AS userNum,
            userName AS userName,
            userPwd AS userPwd,
            userEmail AS userEmail,
            grade,
            userGender,
            userSignupDate
        FROM USER
        WHERE userEmail = #{userEmail}
        AND userPwd = #{userPwd}
    </select>

    <!-- 전체 유저 수 -->
    <select id="countAllUsers" resultType="int">
        SELECT COUNT(*) FROM USER
    </select>

    <!-- 이번 주 가입자 수 (예: 일주일 기준) -->
    <select id="countUsersRegisteredThisWeek" resultType="int">
        SELECT COUNT(*) 
        FROM USER
        WHERE userSignupDate >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)
    </select>

    <!-- 최근 가입자 리스트 (최근 5명 정도) -->
    <select id="selectRecentUsers" resultType="com.cloud.shop.dto.UserDto">
        SELECT userNum, userName, userEmail, userSignupDate
        FROM USER
        ORDER BY userSignupDate DESC
        LIMIT 5
    </select>


</mapper>
